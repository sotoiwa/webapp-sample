language: java
dist: xenial

script:
- cd sample
- mvn clean verify
- cd ../
- cp sample/target/sample.war .
- cp sample/target/liberty/wlp/usr/servers/defaultServer/server.xml .
- cp sample/target/liberty/wlp/usr/shared/resources/mysql-*.jar .
- docker build -t $DOCKER_USERNAME/sample:1.0 .

after_success:
- if [ "$TRAVIS_PULL_REQUEST" = "false" ] && [ "$TRAVIS_BRANCH" = "master" ]; then
    echo "$DOCKER_PASSWORD" | docker login -u "$DOCKER_USERNAME" --password-stdin;
    docker push $DOCKER_USERNAME/sample:1.0;
  fi

notifications:
  slack:
    secure: a0l398gHHfoCbLQmHVBOMoqIMiaxQaTRx2LmkUBIJkR7BCDC6S/jh4Wfzf+l/xYlZUJRVpN0SxI5nDQ4fCYwxRKVuPKRbUfPGKuc3PWYgx0i73qD1LUaQEmAqqo8cY1fnMDdjyE7lg8UUpHz0rNOxMrzCYP5LeMEMzGohR3j7QK01hxiKYJCP6bH3lcPUk8Lsx+RjThNxNnfavJLE87E/Qbu3eYc7kNRwdn3KiLHKUa7g2ZoZ7KsaYXxIU/Vk+vEqOIernInW+lmbcrP/EVEJxqpE/wuZhVc0AzhZRuTk/S/4iJRu6mF9Q3jJfSxvKLAMjerua2wwlhir/RaIYWh3s+6gMNgOdLWXYInnoeGV1EB6mIIAGVMN9DLKJ6rTLbz2y5np0lU0GC4SiqjcPhqEG+C31Fb6lhoMs9mQDJoh1p5BFg4SidW29nqeHa/yHIT8VHbjUHNnr63hRVjb+zqeuKa9MofQ7VzStHgnc/maZWMj7TC+qvH5eCh7PpDqb9D3qxDXUp6It3ShUiavNijIM4UL3CdPVEPxcSlffpSlpGWFDyWc2U65rPSrxu8mKpcCVF5D4agMV/J0lE7VxEA7enA5WR70/AVvFX5wqOt8yGg41EIbrkX6AXSNnNH0nrjHRVCYLBeV6DA6UE9XrfJ1rJ/Ai6ZdVg9ofaHL/AMU5w=
