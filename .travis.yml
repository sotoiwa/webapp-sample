language: java
dist: xenial

script:
- cd sample
- mvn clean verify
- cd ../
- cp sample/target/sample.war .
- cp sample/target/liberty/wlp/usr/servers/defaultServer/server.xml .
- cp sample/target/liberty/wlp/usr/shared/resources/mysql-*.jar .
- docker build -t $DOCKER_USERNAME/sample:1.0 .

after_success:
- if [ "$TRAVIS_PULL_REQUEST" = "false" ] && [ "$TRAVIS_BRANCH" = "master" ]; then
    echo "$DOCKER_PASSWORD" | docker login -u "$DOCKER_USERNAME" --password-stdin;
    docker push $DOCKER_USERNAME/sample:1.0;
  fi

notifications:
  slack:
    secure: Kbo3VgmwcqRozfwEHQfpi8SYqAb7aEbJIQP4N5uepUzXkeWCjbSIIoYRIPZavSNlKsV/TCnAqEKaWsFlQ4UqAvLKjN6gCscdYM5t/pTQWD/kniUP8z7WhB9FWBA49lQG+iezMkBG/1DvtApNY9TNDhSe2Uel2W4+m2Xvg0JvmJG1i9dw6JpUBav+Cj+CKxuQchgKNEABG0o3NjAm2+sxCA2gtBpmg+kRTBTxXYVsBpHupWIqG4gb3Cb+fEJ/qkQMkTDs1kN9K9AnEMBzf6+erzYvMqmcMvNvPIn2IeZn0qgjP47mtPAmpjQDs8wUvUelQ8fBJqKrdPP/OQI6NUygTBcHv8cEHCKS2PWRPp746aCu+CGiEdqGz1A+4T4hfn8+BI3ox5/1ebSgvDAs5g2kkrw3t2hiuNLLF19GyUJxlVlXXrdMccAANSpD3FFqkasDprVx+xSHzIpS6X4yHuwW6nyN0+RSgSc6yMe9GVU2wt5ASxLGjnWBbePhAzObhzxAUe1Gu09kQ33mlM7hELrxVpTvtiBgwhx4F1jLRWIDXWn0dsUGznAk90ydcOeclrhVCEXrXfmOFBjffypwSrBwRLC8JtqOQwkovcHoA7CLgNMgY/KnteYAjOo8RYtUjIzxVTN/fUP4V2qBUWQ9UwWGaiNy025xi6FNlYLqH9I/3qQ=
