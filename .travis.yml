language: java
dist: xenial

script:
- cd sample
- mvn clean verify
- cd ../
- cp sample/target/sample.war .
- cp sample/target/liberty/wlp/usr/servers/defaultServer/server.xml .
- cp sample/target/liberty/wlp/usr/shared/resources/mysql-*.jar .
- docker build -t $DOCKER_USERNAME/sample:1.0 .

after_success:
- if [ "$TRAVIS_PULL_REQUEST" = "false" ] && [ "$TRAVIS_BRANCH" = "master" ]; then
    echo "$DOCKER_PASSWORD" | docker login -u "$DOCKER_USERNAME" --password-stdin;
    docker push $DOCKER_USERNAME/sample:1.0;
  fi

notifications:
  slack:
    secure: "KK+eLaVlG3IXn4pRkv4LjrwxJMoL5apQrEGfbsItbL9/AgGG/6I4muZSTk9vwW9GvHOuTB8kwQlgxfvrfns61V8JiGI/RIABPfywlN9q2eixEkpya8hxNLZvP3/q2vmewcJp535FI8QMDty0ibQJjBRjiDJ4EtfukBtVsmf2hxSobqBG4DdacEMv6X7cTVj3t913Et/84BA6upRglhdpXfFw7zGw24jRv5f8Lk30YpL5Ua50LjbRd5ag2BlcQYrPh21Qr0FUSJMDhrgsDtUpt7WDdU/tSHkZgk52X+I0A2h7UljXNz6iIfoeoUo8ENEGRerGz6Mvj5lXcnw9vx26TojS6IcAr6f8IDzfXkw0+E3q3d9GZZrgXyJ5A6f8nTd2nxwA/IdseaftyZxN63iO0EL8M2codEiIftthcpNZRt0hJZrygJRL3IXJHCRRsEZ5m/haXliOskF9xQf04QoCaFV5ypKNAKIKHYpxgZdS1990uPajRNosDErPcXWkZabThSMKkvjQNan5bBboUuEi4XlZCtR2L6OzWnl5toEviDjW8tXU6UtuArQIOhn+Tw60BW2ZI3Fha4B5UZLwxNq1+8/YFEOGsnrtB1sDrWjBT6GUtBckUOsFcLqL5KNhqllGcm7mXSCkfyT5XJ9Gbb1UW5y9qMe+BRTTzJsJGgnQ89k="
